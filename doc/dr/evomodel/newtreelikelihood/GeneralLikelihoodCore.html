<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_45) on Fri Jun 07 16:03:00 EDT 2013 -->
<TITLE>
GeneralLikelihoodCore
</TITLE>

<META NAME="date" CONTENT="2013-06-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="GeneralLikelihoodCore";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/GeneralLikelihoodCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../dr/evomodel/newtreelikelihood/FloatGeneralLikelihoodCore.html" title="class in dr.evomodel.newtreelikelihood"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../dr/evomodel/newtreelikelihood/GPUInfo.html" title="class in dr.evomodel.newtreelikelihood"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="GeneralLikelihoodCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
dr.evomodel.newtreelikelihood</FONT>
<BR>
Class GeneralLikelihoodCore</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>dr.evomodel.newtreelikelihood.GeneralLikelihoodCore</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>GeneralLikelihoodCore</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></DL>
</PRE>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#categoryProportions">categoryProportions</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#categoryRates">categoryRates</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#cMatrix">cMatrix</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#currentMatricesIndices">currentMatricesIndices</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#currentPartialsIndices">currentPartialsIndices</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#DEBUG">DEBUG</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#debugCount">debugCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#eigenValues">eigenValues</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#frequencies">frequencies</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[][][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#matrices">matrices</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#matrixCount">matrixCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#matrixSize">matrixSize</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#nodeCount">nodeCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[][][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#partials">partials</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#partialsSize">partialsSize</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#patternCount">patternCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[][][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#scalingFactors">scalingFactors</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#stateCount">stateCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#states">states</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#stateTipCount">stateTipCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedCategoryProportions">storedCategoryProportions</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedCategoryRates">storedCategoryRates</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedCMatrix">storedCMatrix</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedEigenValues">storedEigenValues</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedFrequencies">storedFrequencies</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedMatricesIndices">storedMatricesIndices</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storedPartialsIndices">storedPartialsIndices</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#useScaling">useScaling</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#GeneralLikelihoodCore(int)">GeneralLikelihoodCore</A></B>(int&nbsp;stateCount)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#calculateLogLikelihoods(int, double[])">calculateLogLikelihoods</A></B>(int&nbsp;rootNodeIndex,
                        double[]&nbsp;outLogLikelihoods)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates pattern log likelihoods at a node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#calculateTransitionProbabilityMatrices(int, double)">calculateTransitionProbabilityMatrices</A></B>(int&nbsp;nodeIndex,
                                       double&nbsp;branchLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#canHandleDynamicRescaling()">canHandleDynamicRescaling</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#canHandleTipPartials()">canHandleTipPartials</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#canHandleTipStates()">canHandleTipStates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#finalize()">finalize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleans up and deallocates arrays.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#getLogScalingFactor(int)">getLogScalingFactor</A></B>(int&nbsp;pattern)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This function returns the scaling factor for that pattern by summing over
 the log scalings used at each node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#initialize(int, int, int, int)">initialize</A></B>(int&nbsp;nodeCount,
           int&nbsp;stateTipCount,
           int&nbsp;patternCount,
           int&nbsp;matrixCount)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initializes partial likelihood arrays.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#restoreState()">restoreState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restore the stored state</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#scalePartials(int)">scalePartials</A></B>(int&nbsp;nodeIndex)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scale the partials at a given node.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#setTipPartials(int, double[])">setTipPartials</A></B>(int&nbsp;tipIndex,
               double[]&nbsp;partials)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets partials for a tip</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#setTipStates(int, int[])">setTipStates</A></B>(int&nbsp;tipIndex,
             int[]&nbsp;states)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets partials for a tip - these are numbered from 0 and remain
 constant throughout the run.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#storeState()">storeState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Store current state</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updateMatrices(int[], double[], int)">updateMatrices</A></B>(int[]&nbsp;branchUpdateIndices,
               double[]&nbsp;branchLengths,
               int&nbsp;branchUpdateCount)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the branch lengths that are being updated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updatePartials(int[], int[], int)">updatePartials</A></B>(int[]&nbsp;operations,
               int[]&nbsp;dependencies,
               int&nbsp;operationCount)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the updates to be made.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updatePartials(int[], int[], int, boolean)">updatePartials</A></B>(int[]&nbsp;operations,
               int[]&nbsp;dependencies,
               int&nbsp;operationCount,
               boolean&nbsp;rescale)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the updates to be made.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updatePartialsPartials(int, int, int)">updatePartialsPartials</A></B>(int&nbsp;nodeIndex1,
                       int&nbsp;nodeIndex2,
                       int&nbsp;nodeIndex3)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updateSiteModel(dr.evomodel.sitemodel.SiteModel)">updateSiteModel</A></B>(<A HREF="../../../dr/evomodel/sitemodel/SiteModel.html" title="interface in dr.evomodel.sitemodel">SiteModel</A>&nbsp;siteModel)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called when the site model has been updated so rates and proportions
 can be obtained.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updateStatesPartials(int, int, int)">updateStatesPartials</A></B>(int&nbsp;nodeIndex1,
                     int&nbsp;nodeIndex2,
                     int&nbsp;nodeIndex3)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates partial likelihoods at a node when one child has states and one has partials.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updateStatesStates(int, int, int)">updateStatesStates</A></B>(int&nbsp;nodeIndex1,
                   int&nbsp;nodeIndex2,
                   int&nbsp;nodeIndex3)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates partial likelihoods at a node when both children have states.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html#updateSubstitutionModel(dr.evomodel.substmodel.SubstitutionModel)">updateSubstitutionModel</A></B>(<A HREF="../../../dr/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Called when the substitution model has been updated so precalculations
 can be obtained.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="DEBUG"><!-- --></A><H3>
DEBUG</H3>
<PRE>
public static final boolean <B>DEBUG</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evomodel.newtreelikelihood.GeneralLikelihoodCore.DEBUG">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="stateCount"><!-- --></A><H3>
stateCount</H3>
<PRE>
protected final int <B>stateCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodeCount"><!-- --></A><H3>
nodeCount</H3>
<PRE>
protected int <B>nodeCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="stateTipCount"><!-- --></A><H3>
stateTipCount</H3>
<PRE>
protected int <B>stateTipCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="patternCount"><!-- --></A><H3>
patternCount</H3>
<PRE>
protected int <B>patternCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="partialsSize"><!-- --></A><H3>
partialsSize</H3>
<PRE>
protected int <B>partialsSize</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="matrixSize"><!-- --></A><H3>
matrixSize</H3>
<PRE>
protected int <B>matrixSize</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="matrixCount"><!-- --></A><H3>
matrixCount</H3>
<PRE>
protected int <B>matrixCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="cMatrix"><!-- --></A><H3>
cMatrix</H3>
<PRE>
protected double[] <B>cMatrix</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedCMatrix"><!-- --></A><H3>
storedCMatrix</H3>
<PRE>
protected double[] <B>storedCMatrix</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="eigenValues"><!-- --></A><H3>
eigenValues</H3>
<PRE>
protected double[] <B>eigenValues</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedEigenValues"><!-- --></A><H3>
storedEigenValues</H3>
<PRE>
protected double[] <B>storedEigenValues</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="frequencies"><!-- --></A><H3>
frequencies</H3>
<PRE>
protected double[] <B>frequencies</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedFrequencies"><!-- --></A><H3>
storedFrequencies</H3>
<PRE>
protected double[] <B>storedFrequencies</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="categoryProportions"><!-- --></A><H3>
categoryProportions</H3>
<PRE>
protected double[] <B>categoryProportions</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedCategoryProportions"><!-- --></A><H3>
storedCategoryProportions</H3>
<PRE>
protected double[] <B>storedCategoryProportions</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="categoryRates"><!-- --></A><H3>
categoryRates</H3>
<PRE>
protected double[] <B>categoryRates</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedCategoryRates"><!-- --></A><H3>
storedCategoryRates</H3>
<PRE>
protected double[] <B>storedCategoryRates</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="partials"><!-- --></A><H3>
partials</H3>
<PRE>
protected double[][][] <B>partials</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="states"><!-- --></A><H3>
states</H3>
<PRE>
protected int[][] <B>states</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="matrices"><!-- --></A><H3>
matrices</H3>
<PRE>
protected double[][][] <B>matrices</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="currentMatricesIndices"><!-- --></A><H3>
currentMatricesIndices</H3>
<PRE>
protected int[] <B>currentMatricesIndices</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedMatricesIndices"><!-- --></A><H3>
storedMatricesIndices</H3>
<PRE>
protected int[] <B>storedMatricesIndices</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="currentPartialsIndices"><!-- --></A><H3>
currentPartialsIndices</H3>
<PRE>
protected int[] <B>currentPartialsIndices</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="storedPartialsIndices"><!-- --></A><H3>
storedPartialsIndices</H3>
<PRE>
protected int[] <B>storedPartialsIndices</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="useScaling"><!-- --></A><H3>
useScaling</H3>
<PRE>
protected boolean <B>useScaling</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="scalingFactors"><!-- --></A><H3>
scalingFactors</H3>
<PRE>
protected double[][][] <B>scalingFactors</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="debugCount"><!-- --></A><H3>
debugCount</H3>
<PRE>
int <B>debugCount</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="GeneralLikelihoodCore(int)"><!-- --></A><H3>
GeneralLikelihoodCore</H3>
<PRE>
public <B>GeneralLikelihoodCore</B>(int&nbsp;stateCount)</PRE>
<DL>
<DD>Constructor
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>stateCount</CODE> - number of states</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="canHandleTipPartials()"><!-- --></A><H3>
canHandleTipPartials</H3>
<PRE>
public boolean <B>canHandleTipPartials</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#canHandleTipPartials()">canHandleTipPartials</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="canHandleTipStates()"><!-- --></A><H3>
canHandleTipStates</H3>
<PRE>
public boolean <B>canHandleTipStates</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#canHandleTipStates()">canHandleTipStates</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="canHandleDynamicRescaling()"><!-- --></A><H3>
canHandleDynamicRescaling</H3>
<PRE>
public boolean <B>canHandleDynamicRescaling</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="initialize(int, int, int, int)"><!-- --></A><H3>
initialize</H3>
<PRE>
public void <B>initialize</B>(int&nbsp;nodeCount,
                       int&nbsp;stateTipCount,
                       int&nbsp;patternCount,
                       int&nbsp;matrixCount)</PRE>
<DL>
<DD>initializes partial likelihood arrays.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#initialize(int, int, int, int)">initialize</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeCount</CODE> - the number of nodes in the tree<DD><CODE>stateTipCount</CODE> - the number of tips with states (rather than partials - can be zero)<DD><CODE>patternCount</CODE> - the number of patterns<DD><CODE>matrixCount</CODE> - the number of matrices (i.e., number of categories)</DL>
</DD>
</DL>
<HR>

<A NAME="finalize()"><!-- --></A><H3>
finalize</H3>
<PRE>
public void <B>finalize</B>()
              throws java.lang.Throwable</PRE>
<DL>
<DD>cleans up and deallocates arrays.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#finalize()">finalize</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE><DT><B>Overrides:</B><DD><CODE>finalize</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Throwable</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setTipPartials(int, double[])"><!-- --></A><H3>
setTipPartials</H3>
<PRE>
public void <B>setTipPartials</B>(int&nbsp;tipIndex,
                           double[]&nbsp;partials)</PRE>
<DL>
<DD>Sets partials for a tip
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#setTipPartials(int, double[])">setTipPartials</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>tipIndex</CODE> - the tip index<DD><CODE>partials</CODE> - an array of partial likelihoods (patternCount * stateCount)</DL>
</DD>
</DL>
<HR>

<A NAME="setTipStates(int, int[])"><!-- --></A><H3>
setTipStates</H3>
<PRE>
public void <B>setTipStates</B>(int&nbsp;tipIndex,
                         int[]&nbsp;states)</PRE>
<DL>
<DD>Sets partials for a tip - these are numbered from 0 and remain
 constant throughout the run.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#setTipStates(int, int[])">setTipStates</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>tipIndex</CODE> - the tip index<DD><CODE>states</CODE> - an array of patternCount state indices</DL>
</DD>
</DL>
<HR>

<A NAME="updateSubstitutionModel(dr.evomodel.substmodel.SubstitutionModel)"><!-- --></A><H3>
updateSubstitutionModel</H3>
<PRE>
public void <B>updateSubstitutionModel</B>(<A HREF="../../../dr/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel)</PRE>
<DL>
<DD>Called when the substitution model has been updated so precalculations
 can be obtained.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#updateSubstitutionModel(dr.evomodel.substmodel.SubstitutionModel)">updateSubstitutionModel</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>substitutionModel</CODE> - the substitution model</DL>
</DD>
</DL>
<HR>

<A NAME="updateSiteModel(dr.evomodel.sitemodel.SiteModel)"><!-- --></A><H3>
updateSiteModel</H3>
<PRE>
public void <B>updateSiteModel</B>(<A HREF="../../../dr/evomodel/sitemodel/SiteModel.html" title="interface in dr.evomodel.sitemodel">SiteModel</A>&nbsp;siteModel)</PRE>
<DL>
<DD>Called when the site model has been updated so rates and proportions
 can be obtained.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#updateSiteModel(dr.evomodel.sitemodel.SiteModel)">updateSiteModel</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>siteModel</CODE> - the site model</DL>
</DD>
</DL>
<HR>

<A NAME="updateMatrices(int[], double[], int)"><!-- --></A><H3>
updateMatrices</H3>
<PRE>
public void <B>updateMatrices</B>(int[]&nbsp;branchUpdateIndices,
                           double[]&nbsp;branchLengths,
                           int&nbsp;branchUpdateCount)</PRE>
<DL>
<DD>Specify the branch lengths that are being updated. These will be used to construct
 the transition probability matrices for each branch.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#updateMatrices(int[], double[], int)">updateMatrices</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>branchUpdateIndices</CODE> - the node indices of the branches to be updated<DD><CODE>branchLengths</CODE> - the branch lengths of the branches to be updated<DD><CODE>branchUpdateCount</CODE> - the number of branch updates</DL>
</DD>
</DL>
<HR>

<A NAME="calculateTransitionProbabilityMatrices(int, double)"><!-- --></A><H3>
calculateTransitionProbabilityMatrices</H3>
<PRE>
private void <B>calculateTransitionProbabilityMatrices</B>(int&nbsp;nodeIndex,
                                                    double&nbsp;branchLength)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="updatePartials(int[], int[], int, boolean)"><!-- --></A><H3>
updatePartials</H3>
<PRE>
public void <B>updatePartials</B>(int[]&nbsp;operations,
                           int[]&nbsp;dependencies,
                           int&nbsp;operationCount,
                           boolean&nbsp;rescale)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#updatePartials(int[], int[], int, boolean)">LikelihoodCore</A></CODE></B></DD>
<DD>Specify the updates to be made. This specifies which partials are to be
 calculated and by giving the dependencies between the operations, they
 can be done in parallel if required.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#updatePartials(int[], int[], int, boolean)">updatePartials</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>operations</CODE> - an array of partial likelihood calculations to be done.
      This is an array of triplets of node numbers specifying the two source
      (descendent) nodes and the destination node for which the partials are
      being calculated.<DD><CODE>dependencies</CODE> - an array of dependencies for each of the operations
      This is an array of pairs of integers for each of the operations above.
      The first of each pair specifies which future operation is dependent
      on this one. The second is just a boolean (0,1) as to whether this operation
      is dependent on another. If these dependencies are not used then the
      operations can safely be done in order.<DD><CODE>operationCount</CODE> - the number of operators<DD><CODE>rescale</CODE> - indicates if partials should be rescaled during peeling</DL>
</DD>
</DL>
<HR>

<A NAME="updatePartials(int[], int[], int)"><!-- --></A><H3>
updatePartials</H3>
<PRE>
public void <B>updatePartials</B>(int[]&nbsp;operations,
                           int[]&nbsp;dependencies,
                           int&nbsp;operationCount)</PRE>
<DL>
<DD>Specify the updates to be made. This specifies which partials are to be
 calculated and by giving the dependencies between the operations, they
 can be done in parallel if required.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>operations</CODE> - an array of partial likelihood calculations to be done.
      This is an array of triplets of node numbers specifying the two source
      (descendent) nodes and the destination node for which the partials are
      being calculated.<DD><CODE>dependencies</CODE> - an array of dependencies for each of the operations
      This is an array of pairs of integers for each of the operations above.
      The first of each pair specifies which future operation is dependent
      on this one. The second is just a boolean (0,1) as to whether this operation
      is dependent on another. If these dependencies are not used then the
      operations can safely be done in order.<DD><CODE>operationCount</CODE> - the number of operators</DL>
</DD>
</DL>
<HR>

<A NAME="updateStatesStates(int, int, int)"><!-- --></A><H3>
updateStatesStates</H3>
<PRE>
private void <B>updateStatesStates</B>(int&nbsp;nodeIndex1,
                                int&nbsp;nodeIndex2,
                                int&nbsp;nodeIndex3)</PRE>
<DL>
<DD>Calculates partial likelihoods at a node when both children have states.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="updateStatesPartials(int, int, int)"><!-- --></A><H3>
updateStatesPartials</H3>
<PRE>
private void <B>updateStatesPartials</B>(int&nbsp;nodeIndex1,
                                  int&nbsp;nodeIndex2,
                                  int&nbsp;nodeIndex3)</PRE>
<DL>
<DD>Calculates partial likelihoods at a node when one child has states and one has partials.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex1</CODE> - <DD><CODE>nodeIndex2</CODE> - <DD><CODE>nodeIndex3</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="updatePartialsPartials(int, int, int)"><!-- --></A><H3>
updatePartialsPartials</H3>
<PRE>
private void <B>updatePartialsPartials</B>(int&nbsp;nodeIndex1,
                                    int&nbsp;nodeIndex2,
                                    int&nbsp;nodeIndex3)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="scalePartials(int)"><!-- --></A><H3>
scalePartials</H3>
<PRE>
protected void <B>scalePartials</B>(int&nbsp;nodeIndex)</PRE>
<DL>
<DD>Scale the partials at a given node. This uses a scaling suggested by Ziheng Yang in
 Yang (2000) J. Mol. Evol. 51: 423-432
 <p/>
 This function looks over the partial likelihoods for each state at each pattern
 and finds the largest. If this is less than the scalingThreshold (currently set
 to 1E-40) then it rescales the partials for that pattern by dividing by this number
 (i.e., normalizing to between 0, 1). It then stores the log of this scaling.
 This is called for every internal node after the partials are calculated so provides
 most of the performance hit. Ziheng suggests only doing this on a proportion of nodes
 but this sounded like a headache to organize (and he doesn't use the threshold idea
 which improves the performance quite a bit).
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodeIndex</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getLogScalingFactor(int)"><!-- --></A><H3>
getLogScalingFactor</H3>
<PRE>
public double <B>getLogScalingFactor</B>(int&nbsp;pattern)</PRE>
<DL>
<DD>This function returns the scaling factor for that pattern by summing over
 the log scalings used at each node. If scaling is off then this just returns
 a 0.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the log scaling factor</DL>
</DD>
</DL>
<HR>

<A NAME="calculateLogLikelihoods(int, double[])"><!-- --></A><H3>
calculateLogLikelihoods</H3>
<PRE>
public void <B>calculateLogLikelihoods</B>(int&nbsp;rootNodeIndex,
                                    double[]&nbsp;outLogLikelihoods)</PRE>
<DL>
<DD>Calculates pattern log likelihoods at a node.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#calculateLogLikelihoods(int, double[])">calculateLogLikelihoods</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>rootNodeIndex</CODE> - the index of the root node<DD><CODE>outLogLikelihoods</CODE> - an array into which the log likelihoods will go</DL>
</DD>
</DL>
<HR>

<A NAME="storeState()"><!-- --></A><H3>
storeState</H3>
<PRE>
public void <B>storeState</B>()</PRE>
<DL>
<DD>Store current state
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#storeState()">storeState</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="restoreState()"><!-- --></A><H3>
restoreState</H3>
<PRE>
public void <B>restoreState</B>()</PRE>
<DL>
<DD>Restore the stored state
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html#restoreState()">restoreState</A></CODE> in interface <CODE><A HREF="../../../dr/evomodel/newtreelikelihood/LikelihoodCore.html" title="interface in dr.evomodel.newtreelikelihood">LikelihoodCore</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/GeneralLikelihoodCore.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../dr/evomodel/newtreelikelihood/FloatGeneralLikelihoodCore.html" title="class in dr.evomodel.newtreelikelihood"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../dr/evomodel/newtreelikelihood/GPUInfo.html" title="class in dr.evomodel.newtreelikelihood"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evomodel/newtreelikelihood/GeneralLikelihoodCore.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="GeneralLikelihoodCore.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
