<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_45) on Fri Jun 07 16:03:13 EDT 2013 -->
<TITLE>
StructuredColourSampler
</TITLE>

<META NAME="date" CONTENT="2013-06-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="StructuredColourSampler";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StructuredColourSampler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../dr/evolution/colouring/SubstitutionModelToColourChangeMatrix.html" title="class in dr.evolution.colouring"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evolution/colouring/StructuredColourSampler.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StructuredColourSampler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
dr.evolution.colouring</FONT>
<BR>
Class StructuredColourSampler</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>dr.evolution.colouring.StructuredColourSampler</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>StructuredColourSampler</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></DL>
</PRE>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>$Id: StructuredColourSampler.java,v 1.11 2006/09/11 09:33:01 gerton Exp $
          <p/>
          Samples tree colourings from a proposal distribution based on
          Felsenstein mutation process; biased at the nodes for coalescent rates;
          and biased at edges using a mean-field approximation of the branch
          colourings.  This should improve performance for unequal population sizes</DD>
<DT><B>Author:</B></DT>
  <DD>Gerton Lunter</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#_totalIntegratedRate">_totalIntegratedRate</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#avgN0">avgN0</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#avgN1">avgN1</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#colourCount">colourCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugMeanColours">debugMeanColours</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugMessages">debugMessages</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugNodePartials">debugNodePartials</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugProposalProbabilityCalculator">debugProposalProbabilityCalculator</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugRejectionSampler">debugRejectionSampler</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#debugSampleLikelihoods">debugSampleLikelihoods</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;java.text.DecimalFormat</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#df">df</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#equilibriumColours">equilibriumColours</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#interval2Height">interval2Height</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#leafColourCounts">leafColourCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#logNodePartialsRescaling">logNodePartialsRescaling</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#maxIterations">maxIterations</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#meanColourCounts">meanColourCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#node2Interval">node2Interval</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#nodeColours">nodeColours</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#nodeColoursEM">nodeColoursEM</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#nodePartials">nodePartials</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[][][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#nodePartialsEM">nodePartialsEM</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#numIntervals">numIntervals</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#propAffected">propAffected</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#tinyTime">tinyTime</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#useBranchBias">useBranchBias</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#useNodeBias">useNodeBias</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#useSecondColourIteration">useSecondColourIteration</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#StructuredColourSampler(dr.evolution.alignment.Alignment, dr.evolution.tree.Tree, boolean, boolean, boolean)">StructuredColourSampler</A></B>(<A HREF="../../../dr/evolution/alignment/Alignment.html" title="interface in dr.evolution.alignment">Alignment</A>&nbsp;tipColours,
                        <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                        boolean&nbsp;nodeBias,
                        boolean&nbsp;branchBias,
                        boolean&nbsp;secondIteration)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#StructuredColourSampler(dr.evolution.util.TaxonList[], dr.evolution.tree.Tree, boolean, boolean, boolean)">StructuredColourSampler</A></B>(<A HREF="../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>[]&nbsp;tipColours,
                        <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                        boolean&nbsp;nodeBias,
                        boolean&nbsp;branchBias,
                        boolean&nbsp;secondIteration)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#calculateConditionalBranchColouringEM(dr.evolution.tree.NodeRef, double, double, double[], dr.evolution.colouring.BranchColouring)">calculateConditionalBranchColouringEM</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                      double&nbsp;time,
                                      double&nbsp;childHeight,
                                      double[]&nbsp;matrixElements,
                                      <A HREF="../../../dr/evolution/colouring/BranchColouring.html" title="interface in dr.evolution.colouring">BranchColouring</A>&nbsp;branchColouring)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This samples events along an interval, and adds these events to a BranchColouring.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#calculateEMProposal(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation, dr.evolution.colouring.TreeColouring)">calculateEMProposal</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                    <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                    <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp,
                    <A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates proposal density for given colouring
 Requires the results from Felsenstein Backwards pruning, in nodePartials(EM)[] (see pruneEM())</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#calculateMatrixElts(int, dr.evolution.tree.NodeRef, dr.evolution.tree.Tree, double, double, double, dr.evolution.colouring.ColourChangeMatrix)">calculateMatrixElts</A></B>(int&nbsp;curinterval,
                    <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;affectedNode,
                    <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                    double&nbsp;time,
                    double&nbsp;N0,
                    double&nbsp;N1,
                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#calculateMeanColourCounts(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix)">calculateMeanColourCounts</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                          <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#calculateMeanColourCountsEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)">calculateMeanColourCountsEM</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                            <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                            <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#computeIntervals(dr.evolution.tree.Tree, dr.evolution.coalescent.structure.MetaPopulation)">computeIntervals</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                 <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#fillMeanColourCounts(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)">fillMeanColourCounts</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                     <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                     <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#getColour(dr.evolution.tree.NodeRef)">getColour</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#getLeafColourCounts()">getLeafColourCounts</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#getMeanColours(int, dr.evolution.colouring.ColourChangeMatrix)">getMeanColours</A></B>(int&nbsp;nodeNum,
               <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#getMeanColoursEM(int, int, dr.evolution.colouring.ColourChangeMatrix)">getMeanColoursEM</A></B>(int&nbsp;nodeNum,
                 int&nbsp;relativeInterval,
                 <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">getProposalProbability</A></B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;treeColouring,
                       <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                       <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                       <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns proposal probability density of a tree colouring</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#initialize(dr.evolution.tree.Tree)">initialize</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#main(java.lang.String[])">main</A></B>(java.lang.String[]&nbsp;args)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#matrixEvolve(double[], int)">matrixEvolve</A></B>(double[]&nbsp;mx,
             int&nbsp;current)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#matrixPullBack(double[], double[])">matrixPullBack</A></B>(double[]&nbsp;mx,
               double[]&nbsp;vec)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#populateEquilibriumColourArray(dr.evolution.colouring.ColourChangeMatrix)">populateEquilibriumColourArray</A></B>(<A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**************************************************************************************
 <p/>
 Probability- and sampling-related code follows</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#prettyPrint(java.lang.String, double[])">prettyPrint</A></B>(java.lang.String&nbsp;label,
            double[]&nbsp;vec)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#prune(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)">prune</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
      <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
      <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#pruneBranchEM(dr.evolution.colouring.ColourChangeMatrix, double[], dr.evolution.tree.NodeRef, dr.evolution.tree.NodeRef, dr.evolution.tree.Tree, dr.evolution.coalescent.structure.MetaPopulation)">pruneBranchEM</A></B>(<A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
              double[]&nbsp;inState,
              <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;parent,
              <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;child,
              <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
              <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#pruneEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">pruneEM</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
        <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
        <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
        <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#sampleConditionalBranchColouringEM(dr.evolution.tree.NodeRef, int, int, double, double, double[], dr.evolution.colouring.DefaultBranchColouring)">sampleConditionalBranchColouringEM</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                   int&nbsp;parentColour,
                                   int&nbsp;childColour,
                                   double&nbsp;time,
                                   double&nbsp;childHeight,
                                   double[]&nbsp;matrixElements,
                                   <A HREF="../../../dr/evolution/colouring/DefaultBranchColouring.html" title="class in dr.evolution.colouring">DefaultBranchColouring</A>&nbsp;initialBranchColouring)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This samples events along an interval, and adds these events to a BranchColouring.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#sampleEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation, dr.evolution.colouring.DefaultTreeColouring)">sampleEM</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
         <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
         <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
         <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp,
         <A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A>&nbsp;colouring)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Samples internal node colours (from root to tips) and events
 Precondition: parent node has been sampled, descendants have not
 Requires the results from Felsenstein Backwards pruning, in nodePartials(EM)[] (see pruneEM())
 Side effect: updates nodeColours[]</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">sampleTreeColouring</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                    <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Main entry point.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#setColour(dr.evolution.tree.NodeRef, int)">setColour</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
          int&nbsp;colour)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/StructuredColourSampler.html#testMatrix(double[], double[])">testMatrix</A></B>(double[]&nbsp;m,
           double[]&nbsp;r)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="maxIterations"><!-- --></A><H3>
maxIterations</H3>
<PRE>
static final int <B>maxIterations</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.maxIterations">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="tinyTime"><!-- --></A><H3>
tinyTime</H3>
<PRE>
static final double <B>tinyTime</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.tinyTime">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugMessages"><!-- --></A><H3>
debugMessages</H3>
<PRE>
static final boolean <B>debugMessages</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugMessages">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugMeanColours"><!-- --></A><H3>
debugMeanColours</H3>
<PRE>
static final boolean <B>debugMeanColours</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugMeanColours">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugNodePartials"><!-- --></A><H3>
debugNodePartials</H3>
<PRE>
static final boolean <B>debugNodePartials</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugNodePartials">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugSampleLikelihoods"><!-- --></A><H3>
debugSampleLikelihoods</H3>
<PRE>
static final boolean <B>debugSampleLikelihoods</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugSampleLikelihoods">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugRejectionSampler"><!-- --></A><H3>
debugRejectionSampler</H3>
<PRE>
static final boolean <B>debugRejectionSampler</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugRejectionSampler">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="debugProposalProbabilityCalculator"><!-- --></A><H3>
debugProposalProbabilityCalculator</H3>
<PRE>
static final boolean <B>debugProposalProbabilityCalculator</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.debugProposalProbabilityCalculator">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="_totalIntegratedRate"><!-- --></A><H3>
_totalIntegratedRate</H3>
<PRE>
double <B>_totalIntegratedRate</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="df"><!-- --></A><H3>
df</H3>
<PRE>
static final java.text.DecimalFormat <B>df</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="propAffected"><!-- --></A><H3>
propAffected</H3>
<PRE>
static final double <B>propAffected</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.StructuredColourSampler.propAffected">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="useNodeBias"><!-- --></A><H3>
useNodeBias</H3>
<PRE>
private boolean <B>useNodeBias</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="useBranchBias"><!-- --></A><H3>
useBranchBias</H3>
<PRE>
private boolean <B>useBranchBias</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="useSecondColourIteration"><!-- --></A><H3>
useSecondColourIteration</H3>
<PRE>
private boolean <B>useSecondColourIteration</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="colourCount"><!-- --></A><H3>
colourCount</H3>
<PRE>
private final int <B>colourCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodeColours"><!-- --></A><H3>
nodeColours</H3>
<PRE>
private final int[] <B>nodeColours</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="leafColourCounts"><!-- --></A><H3>
leafColourCounts</H3>
<PRE>
private final int[] <B>leafColourCounts</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="meanColourCounts"><!-- --></A><H3>
meanColourCounts</H3>
<PRE>
private double[][] <B>meanColourCounts</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodeColoursEM"><!-- --></A><H3>
nodeColoursEM</H3>
<PRE>
private int[][] <B>nodeColoursEM</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodePartials"><!-- --></A><H3>
nodePartials</H3>
<PRE>
private double[][] <B>nodePartials</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodePartialsEM"><!-- --></A><H3>
nodePartialsEM</H3>
<PRE>
private double[][][] <B>nodePartialsEM</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="logNodePartialsRescaling"><!-- --></A><H3>
logNodePartialsRescaling</H3>
<PRE>
private double <B>logNodePartialsRescaling</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="equilibriumColours"><!-- --></A><H3>
equilibriumColours</H3>
<PRE>
private double[] <B>equilibriumColours</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="node2Interval"><!-- --></A><H3>
node2Interval</H3>
<PRE>
private int[] <B>node2Interval</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="interval2Height"><!-- --></A><H3>
interval2Height</H3>
<PRE>
private double[] <B>interval2Height</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="avgN0"><!-- --></A><H3>
avgN0</H3>
<PRE>
private double[] <B>avgN0</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="avgN1"><!-- --></A><H3>
avgN1</H3>
<PRE>
private double[] <B>avgN1</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="numIntervals"><!-- --></A><H3>
numIntervals</H3>
<PRE>
private int <B>numIntervals</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="StructuredColourSampler(dr.evolution.alignment.Alignment, dr.evolution.tree.Tree, boolean, boolean, boolean)"><!-- --></A><H3>
StructuredColourSampler</H3>
<PRE>
public <B>StructuredColourSampler</B>(<A HREF="../../../dr/evolution/alignment/Alignment.html" title="interface in dr.evolution.alignment">Alignment</A>&nbsp;tipColours,
                               <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                               boolean&nbsp;nodeBias,
                               boolean&nbsp;branchBias,
                               boolean&nbsp;secondIteration)</PRE>
<DL>
</DL>
<HR>

<A NAME="StructuredColourSampler(dr.evolution.util.TaxonList[], dr.evolution.tree.Tree, boolean, boolean, boolean)"><!-- --></A><H3>
StructuredColourSampler</H3>
<PRE>
public <B>StructuredColourSampler</B>(<A HREF="../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>[]&nbsp;tipColours,
                               <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                               boolean&nbsp;nodeBias,
                               boolean&nbsp;branchBias,
                               boolean&nbsp;secondIteration)</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getLeafColourCounts()"><!-- --></A><H3>
getLeafColourCounts</H3>
<PRE>
public int[] <B>getLeafColourCounts</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#getLeafColourCounts()">getLeafColourCounts</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="initialize(dr.evolution.tree.Tree)"><!-- --></A><H3>
initialize</H3>
<PRE>
private void <B>initialize</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="computeIntervals(dr.evolution.tree.Tree, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
computeIntervals</H3>
<PRE>
private void <B>computeIntervals</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                              <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
sampleTreeColouring</H3>
<PRE>
public <A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A> <B>sampleTreeColouring</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                                <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                                                <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD>Main entry point. Colours the tree probabilistically with the given migration rates
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">sampleTreeColouring</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>colourChangeMatrix</CODE> - the colour change rate parameters</DL>
</DD>
</DL>
<HR>

<A NAME="getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
getProposalProbability</H3>
<PRE>
public double <B>getProposalProbability</B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;treeColouring,
                                     <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                     <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                                     <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD>Returns proposal probability density of a tree colouring
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">getProposalProbability</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>treeColouring</CODE> - <DD><CODE>tree</CODE> - <DD><CODE>colourChangeMatrix</CODE> - <DD><CODE>mp</CODE> - 
<DT><B>Returns:</B><DD>probability density</DL>
</DD>
</DL>
<HR>

<A NAME="getColour(dr.evolution.tree.NodeRef)"><!-- --></A><H3>
getColour</H3>
<PRE>
private int <B>getColour</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="setColour(dr.evolution.tree.NodeRef, int)"><!-- --></A><H3>
setColour</H3>
<PRE>
private void <B>setColour</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                       int&nbsp;colour)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="populateEquilibriumColourArray(dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
populateEquilibriumColourArray</H3>
<PRE>
void <B>populateEquilibriumColourArray</B>(<A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD>**************************************************************************************
 <p/>
 Probability- and sampling-related code follows
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getMeanColours(int, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
getMeanColours</H3>
<PRE>
double[] <B>getMeanColours</B>(int&nbsp;nodeNum,
                        <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getMeanColoursEM(int, int, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
getMeanColoursEM</H3>
<PRE>
double[] <B>getMeanColoursEM</B>(int&nbsp;nodeNum,
                          int&nbsp;relativeInterval,
                          <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="fillMeanColourCounts(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
fillMeanColourCounts</H3>
<PRE>
void <B>fillMeanColourCounts</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                          <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                          <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateMeanColourCountsEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
calculateMeanColourCountsEM</H3>
<PRE>
void <B>calculateMeanColourCountsEM</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                 <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                 <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateMeanColourCounts(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
calculateMeanColourCounts</H3>
<PRE>
void <B>calculateMeanColourCounts</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                               <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="prune(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
prune</H3>
<PRE>
private double[] <B>prune</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                       <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                       <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</PRE>
<DL>
<DD>Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.  (First step in the color sampling algorithm)
 Side effect: updates nodePartials[] for this node and all its descendants.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - 
<DT><B>Returns:</B><DD>the partials of this node</DL>
</DD>
</DL>
<HR>

<A NAME="matrixEvolve(double[], int)"><!-- --></A><H3>
matrixEvolve</H3>
<PRE>
static double[] <B>matrixEvolve</B>(double[]&nbsp;mx,
                             int&nbsp;current)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="matrixPullBack(double[], double[])"><!-- --></A><H3>
matrixPullBack</H3>
<PRE>
static void <B>matrixPullBack</B>(double[]&nbsp;mx,
                           double[]&nbsp;vec)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateMatrixElts(int, dr.evolution.tree.NodeRef, dr.evolution.tree.Tree, double, double, double, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
calculateMatrixElts</H3>
<PRE>
double[] <B>calculateMatrixElts</B>(int&nbsp;curinterval,
                             <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;affectedNode,
                             <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                             double&nbsp;time,
                             double&nbsp;N0,
                             double&nbsp;N1,
                             <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="pruneBranchEM(dr.evolution.colouring.ColourChangeMatrix, double[], dr.evolution.tree.NodeRef, dr.evolution.tree.NodeRef, dr.evolution.tree.Tree, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
pruneBranchEM</H3>
<PRE>
double[] <B>pruneBranchEM</B>(<A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                       double[]&nbsp;inState,
                       <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;parent,
                       <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;child,
                       <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                       <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="pruneEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
pruneEM</H3>
<PRE>
private double[] <B>pruneEM</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                         <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                         <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                         <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD>Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.  (First step in the color sampling algorithm)
 Side effect: updates nodePartials[] and nodePartialsEM[][] for this node and all its descendants.
 This version uses mean-field coalescence correction and formal variable correction
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sampleEM(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation, dr.evolution.colouring.DefaultTreeColouring)"><!-- --></A><H3>
sampleEM</H3>
<PRE>
private double <B>sampleEM</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                        <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                        <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                        <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp,
                        <A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A>&nbsp;colouring)</PRE>
<DL>
<DD>Samples internal node colours (from root to tips) and events
 Precondition: parent node has been sampled, descendants have not
 Requires the results from Felsenstein Backwards pruning, in nodePartials(EM)[] (see pruneEM())
 Side effect: updates nodeColours[]
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sampleConditionalBranchColouringEM(dr.evolution.tree.NodeRef, int, int, double, double, double[], dr.evolution.colouring.DefaultBranchColouring)"><!-- --></A><H3>
sampleConditionalBranchColouringEM</H3>
<PRE>
private double <B>sampleConditionalBranchColouringEM</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                                  int&nbsp;parentColour,
                                                  int&nbsp;childColour,
                                                  double&nbsp;time,
                                                  double&nbsp;childHeight,
                                                  double[]&nbsp;matrixElements,
                                                  <A HREF="../../../dr/evolution/colouring/DefaultBranchColouring.html" title="class in dr.evolution.colouring">DefaultBranchColouring</A>&nbsp;initialBranchColouring)</PRE>
<DL>
<DD>This samples events along an interval, and adds these events to a BranchColouring.
 Also returns the (unconditional) log probability density for these events
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateEMProposal(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation, dr.evolution.colouring.TreeColouring)"><!-- --></A><H3>
calculateEMProposal</H3>
<PRE>
private double <B>calculateEMProposal</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                   <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                   <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                                   <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp,
                                   <A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring)</PRE>
<DL>
<DD>Calculates proposal density for given colouring
 Requires the results from Felsenstein Backwards pruning, in nodePartials(EM)[] (see pruneEM())
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateConditionalBranchColouringEM(dr.evolution.tree.NodeRef, double, double, double[], dr.evolution.colouring.BranchColouring)"><!-- --></A><H3>
calculateConditionalBranchColouringEM</H3>
<PRE>
private double <B>calculateConditionalBranchColouringEM</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                                     double&nbsp;time,
                                                     double&nbsp;childHeight,
                                                     double[]&nbsp;matrixElements,
                                                     <A HREF="../../../dr/evolution/colouring/BranchColouring.html" title="interface in dr.evolution.colouring">BranchColouring</A>&nbsp;branchColouring)</PRE>
<DL>
<DD>This samples events along an interval, and adds these events to a BranchColouring.
 Also returns the (unconditional) log probability density for these events
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="prettyPrint(java.lang.String, double[])"><!-- --></A><H3>
prettyPrint</H3>
<PRE>
private void <B>prettyPrint</B>(java.lang.String&nbsp;label,
                         double[]&nbsp;vec)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="testMatrix(double[], double[])"><!-- --></A><H3>
testMatrix</H3>
<PRE>
static void <B>testMatrix</B>(double[]&nbsp;m,
                       double[]&nbsp;r)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="main(java.lang.String[])"><!-- --></A><H3>
main</H3>
<PRE>
public static void <B>main</B>(java.lang.String[]&nbsp;args)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/StructuredColourSampler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../dr/evolution/colouring/SubstitutionModelToColourChangeMatrix.html" title="class in dr.evolution.colouring"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evolution/colouring/StructuredColourSampler.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="StructuredColourSampler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
