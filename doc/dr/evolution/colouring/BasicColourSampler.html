<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_45) on Fri Jun 07 16:03:13 EDT 2013 -->
<TITLE>
BasicColourSampler
</TITLE>

<META NAME="date" CONTENT="2013-06-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BasicColourSampler";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/BasicColourSampler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../dr/evolution/colouring/BranchColouring.html" title="interface in dr.evolution.colouring"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evolution/colouring/BasicColourSampler.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BasicColourSampler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
dr.evolution.colouring</FONT>
<BR>
Class BasicColourSampler</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>dr.evolution.colouring.BasicColourSampler</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>BasicColourSampler</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></DL>
</PRE>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>$Id: BasicColourSampler.java,v 1.16 2006/09/11 09:33:01 gerton Exp $</DD>
<DT><B>Author:</B></DT>
  <DD>Alexei Drummond, Gerton Lunter, Andrew Rambaut
         <p/>
         This is the old version.  It samples like a substitution model, except that nodes are biased
         towards populations with low Ne, since coalescences are more likely to occur there.
         <p/>
         It seems to work less well than a straight substitution-like model (such as Greg Ewing uses).
         The reason is that although the bias is correct, along branches the bias works the other way.
         By incorporating bias at the nodes, the problem along branches gets worse, and this seems to
         affect the acceptance probabilities more than having the right bias at the nodes helps.  So,
         although the code still accepts the population sizes, it ignores it now.</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#colourCount">colourCount</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#leafColourCounts">leafColourCounts</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#maxIterations">maxIterations</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#nodeColours">nodeColours</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[][]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#nodePartials">nodePartials</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#BasicColourSampler(dr.evolution.alignment.Alignment, dr.evolution.tree.Tree)">BasicColourSampler</A></B>(<A HREF="../../../dr/evolution/alignment/Alignment.html" title="interface in dr.evolution.alignment">Alignment</A>&nbsp;tipColours,
                   <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#BasicColourSampler(dr.evolution.util.TaxonList[], dr.evolution.tree.Tree)">BasicColourSampler</A></B>(<A HREF="../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>[]&nbsp;tipColours,
                   <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#calculateLogNormalization(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef)">calculateLogNormalization</A></B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring,
                          <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                          <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#calculateLogProbabilityDensity(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, double[])">calculateLogProbabilityDensity</A></B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring,
                               <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                               <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                               <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                               double[]&nbsp;N)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculates log probability density of the proposal colouring of the tree on the branch leading to this node,
 and everything descending from it.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#getColour(dr.evolution.tree.NodeRef)">getColour</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#getLeafColourCounts()">getLeafColourCounts</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">getProposalProbability</A></B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;treeColouring,
                       <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                       <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                       <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#prune(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, double[])">prune</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
      <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
      <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
      double[]&nbsp;N)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#sampleBranchColourings(dr.evolution.colouring.DefaultTreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)">sampleBranchColourings</A></B>(<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A>&nbsp;colouring,
                       <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                       <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                       <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Samples the colours on a tree branch, between node and its parent, conditional on the colour at these nodes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../dr/evolution/colouring/DefaultBranchColouring.html" title="class in dr.evolution.colouring">DefaultBranchColouring</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#sampleConditionalBranchColouring(int, double, int, double, dr.evolution.colouring.ColourChangeMatrix)">sampleConditionalBranchColouring</A></B>(int&nbsp;parentColour,
                                 double&nbsp;parentHeight,
                                 int&nbsp;childColour,
                                 double&nbsp;childHeight,
                                 <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#sampleInternalNodes(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)">sampleInternalNodes</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                    <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Samples internal node colours (from root to tips)
 Requires the results from Felsenstein Backwards pruning, in nodePartials[] (see prune())
 Side effect: updates nodeColours[]</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">sampleTreeColouring</A></B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                    <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Colours the tree probabilistically with the given migration rates</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../dr/evolution/colouring/BasicColourSampler.html#setColour(dr.evolution.tree.NodeRef, int)">setColour</A></B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
          int&nbsp;colour)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="maxIterations"><!-- --></A><H3>
maxIterations</H3>
<PRE>
static final int <B>maxIterations</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#dr.evolution.colouring.BasicColourSampler.maxIterations">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="colourCount"><!-- --></A><H3>
colourCount</H3>
<PRE>
private final int <B>colourCount</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodeColours"><!-- --></A><H3>
nodeColours</H3>
<PRE>
private int[] <B>nodeColours</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodePartials"><!-- --></A><H3>
nodePartials</H3>
<PRE>
private double[][] <B>nodePartials</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="leafColourCounts"><!-- --></A><H3>
leafColourCounts</H3>
<PRE>
private final int[] <B>leafColourCounts</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="BasicColourSampler(dr.evolution.alignment.Alignment, dr.evolution.tree.Tree)"><!-- --></A><H3>
BasicColourSampler</H3>
<PRE>
public <B>BasicColourSampler</B>(<A HREF="../../../dr/evolution/alignment/Alignment.html" title="interface in dr.evolution.alignment">Alignment</A>&nbsp;tipColours,
                          <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</PRE>
<DL>
</DL>
<HR>

<A NAME="BasicColourSampler(dr.evolution.util.TaxonList[], dr.evolution.tree.Tree)"><!-- --></A><H3>
BasicColourSampler</H3>
<PRE>
public <B>BasicColourSampler</B>(<A HREF="../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>[]&nbsp;tipColours,
                          <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree)</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getLeafColourCounts()"><!-- --></A><H3>
getLeafColourCounts</H3>
<PRE>
public int[] <B>getLeafColourCounts</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#getLeafColourCounts()">getLeafColourCounts</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
sampleTreeColouring</H3>
<PRE>
public <A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A> <B>sampleTreeColouring</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                                <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                                                <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD>Colours the tree probabilistically with the given migration rates
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#sampleTreeColouring(dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">sampleTreeColouring</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>colourChangeMatrix</CODE> - the colour change rate parameters</DL>
</DD>
</DL>
<HR>

<A NAME="getColour(dr.evolution.tree.NodeRef)"><!-- --></A><H3>
getColour</H3>
<PRE>
private final int <B>getColour</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="setColour(dr.evolution.tree.NodeRef, int)"><!-- --></A><H3>
setColour</H3>
<PRE>
private final void <B>setColour</B>(<A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                             int&nbsp;colour)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="prune(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, double[])"><!-- --></A><H3>
prune</H3>
<PRE>
private final double[] <B>prune</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                             <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                             <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                             double[]&nbsp;N)</PRE>
<DL>
<DD>Calculate probability of data at descendants from node, given a color at the node ('partials'),
 by a Felsenstein-like pruning algorithm.  (First step in the color sampling algorithm)
 Side effect: updates nodePartials[] for this node and all its descendants.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - 
<DT><B>Returns:</B><DD>the partials of this node</DL>
</DD>
</DL>
<HR>

<A NAME="sampleInternalNodes(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
sampleInternalNodes</H3>
<PRE>
private final void <B>sampleInternalNodes</B>(<A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                       <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                       <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</PRE>
<DL>
<DD>Samples internal node colours (from root to tips)
 Requires the results from Felsenstein Backwards pruning, in nodePartials[] (see prune())
 Side effect: updates nodeColours[]
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sampleBranchColourings(dr.evolution.colouring.DefaultTreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
sampleBranchColourings</H3>
<PRE>
private void <B>sampleBranchColourings</B>(<A HREF="../../../dr/evolution/colouring/DefaultTreeColouring.html" title="class in dr.evolution.colouring">DefaultTreeColouring</A>&nbsp;colouring,
                                    <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                    <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</PRE>
<DL>
<DD>Samples the colours on a tree branch, between node and its parent, conditional on the colour at these nodes.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - the node above which to sample changes</DL>
</DD>
</DL>
<HR>

<A NAME="sampleConditionalBranchColouring(int, double, int, double, dr.evolution.colouring.ColourChangeMatrix)"><!-- --></A><H3>
sampleConditionalBranchColouring</H3>
<PRE>
private <A HREF="../../../dr/evolution/colouring/DefaultBranchColouring.html" title="class in dr.evolution.colouring">DefaultBranchColouring</A> <B>sampleConditionalBranchColouring</B>(int&nbsp;parentColour,
                                                                double&nbsp;parentHeight,
                                                                int&nbsp;childColour,
                                                                double&nbsp;childHeight,
                                                                <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateLogProbabilityDensity(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.evolution.colouring.ColourChangeMatrix, double[])"><!-- --></A><H3>
calculateLogProbabilityDensity</H3>
<PRE>
private final double <B>calculateLogProbabilityDensity</B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring,
                                                    <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                                    <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                                                    <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;mm,
                                                    double[]&nbsp;N)</PRE>
<DL>
<DD>Calculates log probability density of the proposal colouring of the tree on the branch leading to this node,
 and everything descending from it.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="calculateLogNormalization(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.tree.NodeRef)"><!-- --></A><H3>
calculateLogNormalization</H3>
<PRE>
public static final double <B>calculateLogNormalization</B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;colouring,
                                                     <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                                     <A HREF="../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)"><!-- --></A><H3>
getProposalProbability</H3>
<PRE>
public double <B>getProposalProbability</B>(<A HREF="../../../dr/evolution/colouring/TreeColouring.html" title="interface in dr.evolution.colouring">TreeColouring</A>&nbsp;treeColouring,
                                     <A HREF="../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                                     <A HREF="../../../dr/evolution/colouring/ColourChangeMatrix.html" title="class in dr.evolution.colouring">ColourChangeMatrix</A>&nbsp;colourChangeMatrix,
                                     <A HREF="../../../dr/evolution/coalescent/structure/MetaPopulation.html" title="interface in dr.evolution.coalescent.structure">MetaPopulation</A>&nbsp;mp)</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html#getProposalProbability(dr.evolution.colouring.TreeColouring, dr.evolution.tree.Tree, dr.evolution.colouring.ColourChangeMatrix, dr.evolution.coalescent.structure.MetaPopulation)">getProposalProbability</A></CODE> in interface <CODE><A HREF="../../../dr/evolution/colouring/ColourSampler.html" title="interface in dr.evolution.colouring">ColourSampler</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/BasicColourSampler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../dr/evolution/colouring/BranchColouring.html" title="interface in dr.evolution.colouring"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?dr/evolution/colouring/BasicColourSampler.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BasicColourSampler.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
