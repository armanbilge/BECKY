<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_45) on Fri Jun 07 16:03:19 EDT 2013 -->
<TITLE>
BranchSpecificBranchModel
</TITLE>

<META NAME="date" CONTENT="2013-06-07">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BranchSpecificBranchModel";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/BranchSpecificBranchModel.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BranchSpecificBranchModel.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
dr.app.beagle.evomodel.branchmodel</FONT>
<BR>
Class BranchSpecificBranchModel</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">dr.inference.model.AbstractModel</A>
      <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>dr.app.beagle.evomodel.branchmodel.BranchSpecificBranchModel</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A>, <A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A>, <A HREF="../../../../../dr/inference/model/ModelListener.html" title="interface in dr.inference.model">ModelListener</A>, <A HREF="../../../../../dr/inference/model/StatisticList.html" title="interface in dr.inference.model">StatisticList</A>, <A HREF="../../../../../dr/inference/model/VariableListener.html" title="interface in dr.inference.model">VariableListener</A>, <A HREF="../../../../../dr/inference/parallel/MPISerializable.html" title="interface in dr.inference.parallel">MPISerializable</A>, <A HREF="../../../../../dr/util/Identifiable.html" title="interface in dr.util">Identifiable</A>, java.io.Serializable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>BranchSpecificBranchModel</B><DT>extends <A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A><DT>implements <A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></DL>
</PRE>

<P>
A branch model which allows different clades (defined by MRCAs of taxon lists) to have different
 substitution models.
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>$Id$</DD>
<DT><B>Author:</B></DT>
  <DD>Andrew Rambaut</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../../serialized-form.html#dr.app.beagle.evomodel.branchmodel.BranchSpecificBranchModel">Serialized Form</A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel">BranchSpecificBranchModel.Clade</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="nested_classes_inherited_from_class_dr.app.beagle.evomodel.branchmodel.BranchModel"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Nested classes/interfaces inherited from interface dr.app.beagle.evomodel.branchmodel.<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel.Mapping</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<A NAME="nested_classes_inherited_from_class_dr.inference.model.Model"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Nested classes/interfaces inherited from interface dr.inference.model.<A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/inference/model/Model.ListenerHelper.html" title="class in dr.inference.model">Model.ListenerHelper</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.Map&lt;java.util.BitSet,<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel">BranchSpecificBranchModel.Clade</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#clades">clades</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map&lt;<A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>,<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel.Mapping</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#nodeMap">nodeMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#requiresMatrixConvolution">requiresMatrixConvolution</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#rootSubstitutionModel">rootSubstitutionModel</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.List&lt;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#substitutionModels">substitutionModels</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../../dr/evomodel/tree/TreeModel.html" title="class in dr.evomodel.tree">TreeModel</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#treeModel">treeModel</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#updateNodeMaps">updateNodeMaps</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_dr.inference.model.AbstractModel"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class dr.inference.model.<A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#listenerHelper">listenerHelper</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_dr.app.beagle.evomodel.branchmodel.BranchModel"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface dr.app.beagle.evomodel.branchmodel.<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#DEFAULT">DEFAULT</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_dr.inference.model.Model"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface dr.inference.model.<A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/inference/model/Model.html#FULL_MODEL_SET">FULL_MODEL_SET</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#BranchSpecificBranchModel(dr.evomodel.tree.TreeModel, dr.app.beagle.evomodel.substmodel.SubstitutionModel)">BranchSpecificBranchModel</A></B>(<A HREF="../../../../../dr/evomodel/tree/TreeModel.html" title="class in dr.evomodel.tree">TreeModel</A>&nbsp;treeModel,
                          <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;rootSubstitutionModel)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#acceptState()">acceptState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This call specifies that the current state is accept.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#addBackbone(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel)">addBackbone</A></B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
            <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#addClade(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel, double)">addClade</A></B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
         <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel,
         double&nbsp;stemWeight)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a substitution model specific to a clade.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#addExternalBranches(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel, double)">addExternalBranches</A></B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
                    <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel,
                    double&nbsp;weight)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel.Mapping</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#getBranchModelMapping(dr.evolution.tree.NodeRef)">getBranchModelMapping</A></B>(<A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;branch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a mapping of substitution models to the given branch.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/FrequencyModel.html" title="class in dr.app.beagle.evomodel.substmodel">FrequencyModel</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#getRootFrequencyModel()">getRootFrequencyModel</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the frequency model that will be applied at the root.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#getRootSubstitutionModel()">getRootSubstitutionModel</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the substitution model that will be applied at the root.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.List&lt;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#getSubstitutionModels()">getSubstitutionModels</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets the list of substitution models in order they will be referred to
 by the indices returned by the mappings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#handleModelChangedEvent(dr.inference.model.Model, java.lang.Object, int)">handleModelChangedEvent</A></B>(<A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A>&nbsp;model,
                        java.lang.Object&nbsp;object,
                        int&nbsp;index)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#handleVariableChangedEvent(dr.inference.model.Variable, int, dr.inference.model.Variable.ChangeType)">handleVariableChangedEvent</A></B>(<A HREF="../../../../../dr/inference/model/Variable.html" title="interface in dr.inference.model">Variable</A>&nbsp;variable,
                           int&nbsp;index,
                           <A HREF="../../../../../dr/inference/model/Variable.ChangeType.html" title="enum in dr.inference.model">Variable.ChangeType</A>&nbsp;type)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method is called whenever a parameter is changed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#requiresMatrixConvolution()">requiresMatrixConvolution</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Is this model going to require convolution of matrices along any branches (essentially
 are the mappings ever going to return more than one substitution model.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#restoreState()">restoreState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;After this call the model is guaranteed to have returned its extra state information to
 the values coinciding with the last storeState call.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#setNodeMap(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.app.beagle.evomodel.branchmodel.BranchSpecificBranchModel.Clade)">setNodeMap</A></B>(<A HREF="../../../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
           <A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
           <A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel">BranchSpecificBranchModel.Clade</A>&nbsp;clade)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#setupNodeMaps()">setupNodeMaps</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#setupNodeMaps(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, java.util.BitSet)">setupNodeMaps</A></B>(<A HREF="../../../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
              <A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
              java.util.BitSet&nbsp;tips)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html#storeState()">storeState</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Additional state information, outside of the sub-model is stored by this call.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_dr.inference.model.AbstractModel"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class dr.inference.model.<A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#acceptModelState()">acceptModelState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#addModel(dr.inference.model.Model)">addModel</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#addModelListener(dr.inference.model.ModelListener)">addModelListener</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#addModelRestoreListener(dr.inference.model.ModelListener)">addModelRestoreListener</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#addStatistic(dr.inference.model.Statistic)">addStatistic</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#addVariable(dr.inference.model.Variable)">addVariable</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#createElement(org.w3c.dom.Document)">createElement</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#fireModelChanged()">fireModelChanged</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#fireModelChanged(java.lang.Object)">fireModelChanged</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#fireModelChanged(java.lang.Object, int)">fireModelChanged</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getId()">getId</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getModel(int)">getModel</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getModelCount()">getModelCount</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getModelName()">getModelName</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getStatistic(int)">getStatistic</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getStatistic(java.lang.String)">getStatistic</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getStatisticCount()">getStatisticCount</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getVariable(int)">getVariable</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#getVariableCount()">getVariableCount</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#hasVariable(dr.inference.model.Variable)">hasVariable</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#isUsed()">isUsed</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#isValidState()">isValidState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#modelChangedEvent(dr.inference.model.Model, java.lang.Object, int)">modelChangedEvent</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#modelRestored(dr.inference.model.Model)">modelRestored</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#receiveState(int)">receiveState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#receiveStateNoParameters(int)">receiveStateNoParameters</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#removeModel(dr.inference.model.Model)">removeModel</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#removeModelListener(dr.inference.model.ModelListener)">removeModelListener</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#removeStatistic(dr.inference.model.Statistic)">removeStatistic</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#removeVariable(dr.inference.model.Variable)">removeVariable</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#restoreModelState()">restoreModelState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#sendState(int)">sendState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#sendStateNoParameters(int)">sendStateNoParameters</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#setId(java.lang.String)">setId</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#storeModelState()">storeModelState</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#toString()">toString</A>, <A HREF="../../../../../dr/inference/model/AbstractModel.html#variableChangedEvent(dr.inference.model.Variable, int, dr.inference.model.Variable.ChangeType)">variableChangedEvent</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_dr.inference.model.Model"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface dr.inference.model.<A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/inference/model/Model.html#acceptModelState()">acceptModelState</A>, <A HREF="../../../../../dr/inference/model/Model.html#addModelListener(dr.inference.model.ModelListener)">addModelListener</A>, <A HREF="../../../../../dr/inference/model/Model.html#getModel(int)">getModel</A>, <A HREF="../../../../../dr/inference/model/Model.html#getModelCount()">getModelCount</A>, <A HREF="../../../../../dr/inference/model/Model.html#getModelName()">getModelName</A>, <A HREF="../../../../../dr/inference/model/Model.html#getVariable(int)">getVariable</A>, <A HREF="../../../../../dr/inference/model/Model.html#getVariableCount()">getVariableCount</A>, <A HREF="../../../../../dr/inference/model/Model.html#isUsed()">isUsed</A>, <A HREF="../../../../../dr/inference/model/Model.html#isValidState()">isValidState</A>, <A HREF="../../../../../dr/inference/model/Model.html#removeModelListener(dr.inference.model.ModelListener)">removeModelListener</A>, <A HREF="../../../../../dr/inference/model/Model.html#restoreModelState()">restoreModelState</A>, <A HREF="../../../../../dr/inference/model/Model.html#storeModelState()">storeModelState</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_dr.util.Identifiable"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface dr.util.<A HREF="../../../../../dr/util/Identifiable.html" title="interface in dr.util">Identifiable</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../../dr/util/Identifiable.html#getId()">getId</A>, <A HREF="../../../../../dr/util/Identifiable.html#setId(java.lang.String)">setId</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="treeModel"><!-- --></A><H3>
treeModel</H3>
<PRE>
private <A HREF="../../../../../dr/evomodel/tree/TreeModel.html" title="class in dr.evomodel.tree">TreeModel</A> <B>treeModel</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="clades"><!-- --></A><H3>
clades</H3>
<PRE>
protected java.util.Map&lt;java.util.BitSet,<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel">BranchSpecificBranchModel.Clade</A>&gt; <B>clades</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="updateNodeMaps"><!-- --></A><H3>
updateNodeMaps</H3>
<PRE>
private boolean <B>updateNodeMaps</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="nodeMap"><!-- --></A><H3>
nodeMap</H3>
<PRE>
private java.util.Map&lt;<A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>,<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel.Mapping</A>&gt; <B>nodeMap</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="rootSubstitutionModel"><!-- --></A><H3>
rootSubstitutionModel</H3>
<PRE>
private final <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A> <B>rootSubstitutionModel</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="substitutionModels"><!-- --></A><H3>
substitutionModels</H3>
<PRE>
private final java.util.List&lt;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&gt; <B>substitutionModels</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="requiresMatrixConvolution"><!-- --></A><H3>
requiresMatrixConvolution</H3>
<PRE>
private boolean <B>requiresMatrixConvolution</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="BranchSpecificBranchModel(dr.evomodel.tree.TreeModel, dr.app.beagle.evomodel.substmodel.SubstitutionModel)"><!-- --></A><H3>
BranchSpecificBranchModel</H3>
<PRE>
public <B>BranchSpecificBranchModel</B>(<A HREF="../../../../../dr/evomodel/tree/TreeModel.html" title="class in dr.evomodel.tree">TreeModel</A>&nbsp;treeModel,
                                 <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;rootSubstitutionModel)</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="addClade(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel, double)"><!-- --></A><H3>
addClade</H3>
<PRE>
public void <B>addClade</B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
                     <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel,
                     double&nbsp;stemWeight)
              throws <A HREF="../../../../../dr/evolution/tree/Tree.MissingTaxonException.html" title="class in dr.evolution.tree">Tree.MissingTaxonException</A></PRE>
<DL>
<DD>Adds a substitution model specific to a clade.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>taxonList</CODE> - a list of taxa who's MRCA define the clade<DD><CODE>substitutionModel</CODE> - the substitution model<DD><CODE>stemWeight</CODE> - the proportion of the stem branch to include in this model (0, 1)
<DT><B>Throws:</B>
<DD><CODE>Tree.MissingTaxonException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="addExternalBranches(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel, double)"><!-- --></A><H3>
addExternalBranches</H3>
<PRE>
public void <B>addExternalBranches</B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
                                <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel,
                                double&nbsp;weight)
                         throws <A HREF="../../../../../dr/evolution/tree/Tree.MissingTaxonException.html" title="class in dr.evolution.tree">Tree.MissingTaxonException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../dr/evolution/tree/Tree.MissingTaxonException.html" title="class in dr.evolution.tree">Tree.MissingTaxonException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="addBackbone(dr.evolution.util.TaxonList, dr.app.beagle.evomodel.substmodel.SubstitutionModel)"><!-- --></A><H3>
addBackbone</H3>
<PRE>
public void <B>addBackbone</B>(<A HREF="../../../../../dr/evolution/util/TaxonList.html" title="interface in dr.evolution.util">TaxonList</A>&nbsp;taxonList,
                        <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&nbsp;substitutionModel)
                 throws <A HREF="../../../../../dr/evolution/tree/Tree.MissingTaxonException.html" title="class in dr.evolution.tree">Tree.MissingTaxonException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../dr/evolution/tree/Tree.MissingTaxonException.html" title="class in dr.evolution.tree">Tree.MissingTaxonException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getBranchModelMapping(dr.evolution.tree.NodeRef)"><!-- --></A><H3>
getBranchModelMapping</H3>
<PRE>
public <A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel.Mapping</A> <B>getBranchModelMapping</B>(<A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;branch)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getBranchModelMapping(dr.evolution.tree.NodeRef)">BranchModel</A></CODE></B></DD>
<DD>Returns a mapping of substitution models to the given branch. The Mapping
 contains a list of substitution models in order from tipward to rootward
 and a set of relative weights for each (may be times or proportions).
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getBranchModelMapping(dr.evolution.tree.NodeRef)">getBranchModelMapping</A></CODE> in interface <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>branch</CODE> - the branch
<DT><B>Returns:</B><DD>a Mapping object</DL>
</DD>
</DL>
<HR>

<A NAME="getSubstitutionModels()"><!-- --></A><H3>
getSubstitutionModels</H3>
<PRE>
public java.util.List&lt;<A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A>&gt; <B>getSubstitutionModels</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getSubstitutionModels()">BranchModel</A></CODE></B></DD>
<DD>Gets the list of substitution models in order they will be referred to
 by the indices returned by the mappings.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getSubstitutionModels()">getSubstitutionModels</A></CODE> in interface <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the list of substitution models</DL>
</DD>
</DL>
<HR>

<A NAME="getRootSubstitutionModel()"><!-- --></A><H3>
getRootSubstitutionModel</H3>
<PRE>
public <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/SubstitutionModel.html" title="interface in dr.app.beagle.evomodel.substmodel">SubstitutionModel</A> <B>getRootSubstitutionModel</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getRootSubstitutionModel()">BranchModel</A></CODE></B></DD>
<DD>Gets the substitution model that will be applied at the root.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getRootSubstitutionModel()">getRootSubstitutionModel</A></CODE> in interface <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the substitution model</DL>
</DD>
</DL>
<HR>

<A NAME="getRootFrequencyModel()"><!-- --></A><H3>
getRootFrequencyModel</H3>
<PRE>
public <A HREF="../../../../../dr/app/beagle/evomodel/substmodel/FrequencyModel.html" title="class in dr.app.beagle.evomodel.substmodel">FrequencyModel</A> <B>getRootFrequencyModel</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getRootFrequencyModel()">BranchModel</A></CODE></B></DD>
<DD>Gets the frequency model that will be applied at the root.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#getRootFrequencyModel()">getRootFrequencyModel</A></CODE> in interface <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the substitution model</DL>
</DD>
</DL>
<HR>

<A NAME="requiresMatrixConvolution()"><!-- --></A><H3>
requiresMatrixConvolution</H3>
<PRE>
public boolean <B>requiresMatrixConvolution</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#requiresMatrixConvolution()">BranchModel</A></CODE></B></DD>
<DD>Is this model going to require convolution of matrices along any branches (essentially
 are the mappings ever going to return more than one substitution model.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html#requiresMatrixConvolution()">requiresMatrixConvolution</A></CODE> in interface <CODE><A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.html" title="interface in dr.app.beagle.evomodel.branchmodel">BranchModel</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>does it?</DL>
</DD>
</DL>
<HR>

<A NAME="handleModelChangedEvent(dr.inference.model.Model, java.lang.Object, int)"><!-- --></A><H3>
handleModelChangedEvent</H3>
<PRE>
public void <B>handleModelChangedEvent</B>(<A HREF="../../../../../dr/inference/model/Model.html" title="interface in dr.inference.model">Model</A>&nbsp;model,
                                    java.lang.Object&nbsp;object,
                                    int&nbsp;index)</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#handleModelChangedEvent(dr.inference.model.Model, java.lang.Object, int)">handleModelChangedEvent</A></CODE> in class <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="handleVariableChangedEvent(dr.inference.model.Variable, int, dr.inference.model.Variable.ChangeType)"><!-- --></A><H3>
handleVariableChangedEvent</H3>
<PRE>
protected final void <B>handleVariableChangedEvent</B>(<A HREF="../../../../../dr/inference/model/Variable.html" title="interface in dr.inference.model">Variable</A>&nbsp;variable,
                                                int&nbsp;index,
                                                <A HREF="../../../../../dr/inference/model/Variable.ChangeType.html" title="enum in dr.inference.model">Variable.ChangeType</A>&nbsp;type)</PRE>
<DL>
<DD><B>Description copied from class: <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#handleVariableChangedEvent(dr.inference.model.Variable, int, dr.inference.model.Variable.ChangeType)">AbstractModel</A></CODE></B></DD>
<DD>This method is called whenever a parameter is changed.
 <p/>
 It is strongly recommended that the model component sets a "dirty" flag and does no
 further calculations. Recalculation is typically done when the model component is asked for
 some information that requires them. This mechanism is 'lazy' so that this method
 can be safely called multiple times with minimal computational cost.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#handleVariableChangedEvent(dr.inference.model.Variable, int, dr.inference.model.Variable.ChangeType)">handleVariableChangedEvent</A></CODE> in class <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="storeState()"><!-- --></A><H3>
storeState</H3>
<PRE>
protected void <B>storeState</B>()</PRE>
<DL>
<DD><B>Description copied from class: <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#storeState()">AbstractModel</A></CODE></B></DD>
<DD>Additional state information, outside of the sub-model is stored by this call.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#storeState()">storeState</A></CODE> in class <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="restoreState()"><!-- --></A><H3>
restoreState</H3>
<PRE>
protected void <B>restoreState</B>()</PRE>
<DL>
<DD><B>Description copied from class: <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#restoreState()">AbstractModel</A></CODE></B></DD>
<DD>After this call the model is guaranteed to have returned its extra state information to
 the values coinciding with the last storeState call.
 Sub-models are handled automatically and do not need to be considered in this method.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#restoreState()">restoreState</A></CODE> in class <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="acceptState()"><!-- --></A><H3>
acceptState</H3>
<PRE>
protected void <B>acceptState</B>()</PRE>
<DL>
<DD><B>Description copied from class: <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#acceptState()">AbstractModel</A></CODE></B></DD>
<DD>This call specifies that the current state is accept. Most models will not need to do anything.
 Sub-models are handled automatically and do not need to be considered in this method.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html#acceptState()">acceptState</A></CODE> in class <CODE><A HREF="../../../../../dr/inference/model/AbstractModel.html" title="class in dr.inference.model">AbstractModel</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setupNodeMaps()"><!-- --></A><H3>
setupNodeMaps</H3>
<PRE>
private void <B>setupNodeMaps</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setupNodeMaps(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, java.util.BitSet)"><!-- --></A><H3>
setupNodeMaps</H3>
<PRE>
private void <B>setupNodeMaps</B>(<A HREF="../../../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                           <A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                           java.util.BitSet&nbsp;tips)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setNodeMap(dr.evolution.tree.Tree, dr.evolution.tree.NodeRef, dr.app.beagle.evomodel.branchmodel.BranchSpecificBranchModel.Clade)"><!-- --></A><H3>
setNodeMap</H3>
<PRE>
private void <B>setNodeMap</B>(<A HREF="../../../../../dr/evolution/tree/Tree.html" title="interface in dr.evolution.tree">Tree</A>&nbsp;tree,
                        <A HREF="../../../../../dr/evolution/tree/NodeRef.html" title="interface in dr.evolution.tree">NodeRef</A>&nbsp;node,
                        <A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel">BranchSpecificBranchModel.Clade</A>&nbsp;clade)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/BranchSpecificBranchModel.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchModel.Mapping.html" title="interface in dr.app.beagle.evomodel.branchmodel"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.Clade.html" title="class in dr.app.beagle.evomodel.branchmodel"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?dr/app/beagle/evomodel/branchmodel/BranchSpecificBranchModel.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BranchSpecificBranchModel.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
