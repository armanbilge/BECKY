<?xml version="1.0" encoding="UTF-8"?>
<project name="BeagleSequenceSimulator" default="help" basedir=".">

   <property name="build.sysclasspath" value="last" />
   <property name="Main-Class" value="dr.app.bss.BeagleSequenceSimulatorApp" />
   <property name="JDK_VERSION" value="1.6" />
   <property name="src" location="src"/>
   <property name="build" location="build" />
   <property name="dist" location="dist" />
   <property name="lib" location="lib" />


   <target name="help">
      <echo message="Common build targets:" />
      <echo message="jar - Builds bss.jar" />
      <echo message="build - Same as clean+jar" />
      <echo message="compile - Compiles bss classes" />
      <echo message="clean - Remove all *.class and bss.jar" />
   </target>


    <path id="classpath">
        <fileset dir="${lib}" includes="**/*.jar"/>
    </path>


   <target name="build" depends="clean,jar" />


   <target name="jar" depends="compile">
      <mkdir dir="${dist}" />

      <jar jarfile="${dist}/bss.jar">

         <manifest>
            <attribute name="Built-By" value="${user.name}" />
            <attribute name="Main-Class" value="${Main-Class}" />
         </manifest>

         <fileset dir="${build}">
            <include name="dr/app/bss/**/*.class" />
            <include name="dr/inference/model/**/*.class" />
            <include name="dr/inference/loggers/**/*.class" />
            <include name="dr/inference/distribution/**/*.class" />
            <include name="dr/evomodel/branchratemodel/**/*.class" />
            <include name="dr/app/beagle/evomodel/substmodel/**/*.class" />
            <include name="dr/app/beagle/evomodel/branchmodel/**/*.class" />
            <include name="dr/inference/parallel/**/*.class**" />
            <include name="dr/app/beagle/evomodel/sitemodel/**/*.class" />
            <include name="dr/app/beauti/options/**/*.class" />
            <include name="dr/app/beauti/tipdatepanel/**/*.class" />
            <include name="dr/app/gui/table/**/*.class" />
            <include name="dr/app/gui/components/**/*.class" />
            <include name="dr/app/beauti/util/**/*.class" />
            <include name="dr/evomodel/tree/**/*.class" />
            <include name="dr/app/beagle/tools/**/*.class" />
            <include name="dr/app/beagle/evomodel/treelikelihood/**/*.class" />
            <include name="dr/app/beagle/evomodel/treelikelihood/**/*.class" />
            <include name="dr/app/util/**/*.class" />
            <include name="dr/evolution/alignment/**/*.class" />
            <include name="dr/evolution/coalescent/**/*.class" />
            <include name="dr/evolution/colouring/**/*.class" />
            <include name="dr/evolution/datatype/**/*.class" />
            <include name="dr/evolution/distance/**/*.class" />
            <include name="dr/evolution/io/**/*.class" />
            <include name="dr/evolution/parsimony/**/*.class" />
            <include name="dr/evolution/sequence/**/*.class" />
            <include name="dr/evolution/tree/**/*.class" />
            <include name="dr/evolution/util/**/*.class" />
            <include name="dr/evoxml/**/*.class" />
            <include name="dr/gui/table/**/*.class" />
            <include name="dr/inference/trace/**/*.class" />
            <include name="dr/math/**/*.class" />
            <include name="dr/matrix/**/*.class" />
            <include name="dr/stats/**/*.class" />
            <include name="dr/util/**/*.class" />
            <include name="dr/xml/**/*.class" />
			<include name="dr/evomodelxml/branchratemodel/**/*.class" />
			<include name="dr/evomodelxml/coalescent/**/*.class" />
			<include name="dr/evomodelxml/sitemodel/**/*.class" />
			<include name="dr/evomodelxml/tree/**/*.class" />
			<include name="dr/app/beagle/tools/parsers/**/*.class" />
			<include name="dr/evolution/io/Importer/**/*.class" />

         </fileset>

         <zipgroupfileset dir="${lib}" includes="jam.jar" />
         <zipgroupfileset dir="${lib}" includes="beagle.jar" />
         <zipgroupfileset dir="${lib}" includes="commons-math-2.2.jar" />

		<fileset dir="${src}">
			<include name="dr/**/*.png"/>
		</fileset>

      </jar>
   </target>


   <target name="compile">
      <mkdir dir="${build}" />

      <javac source="${JDK_VERSION}" target="${JDK_VERSION}" srcdir="${src}" destdir="${build}" classpathref="classpath">

         <include name="dr/app/bss/**" />
         <include name="dr/inference/model/**" />
         <include name="dr/inference/loggers/**" />
          <include name="dr/inference/distribution/**" />
         <include name="dr/evomodel/branchratemodel/**" />
         <include name="dr/app/beagle/evomodel/substmodel/**" />
         <include name="dr/app/beagle/evomodel/branchmodel/**" />
         <include name="dr/inference/parallel/**" />
         <include name="dr/app/beagle/evomodel/sitemodel/**" />
         <include name="dr/app/beauti/options/**" />
         <include name="dr/app/beauti/tipdatepanel/**" />
         <include name="dr/app/gui/table/**" />
         <include name="dr/app/gui/components/**" />
         <include name="dr/app/beauti/util/**" />
         <include name="dr/evomodel/tree/**" />
         <include name="dr/app/beagle/tools/**" />
         <include name="dr/app/beagle/evomodel/treelikelihood/**" />
         <include name="dr/app/util/**" />
         <include name="dr/evolution/alignment/**" />
         <include name="dr/evolution/colouring/**" />
         <include name="dr/evolution/datatype/**" />
         <include name="dr/evolution/distance/**" />
         <include name="dr/evolution/io/**" />
         <include name="dr/evolution/parsimony/**" />
         <include name="dr/evolution/sequence/**" />
         <include name="dr/evolution/tree/**" />
         <include name="dr/evolution/util/**" />
         <include name="dr/evoxml/**" />
         <include name="dr/gui/table/**" />
         <include name="dr/inference/trace/**" />
         <include name="dr/math/**" />
         <include name="dr/matrix/**" />
         <include name="dr/stats/**" />
         <include name="dr/util/**" />
         <include name="dr/xml/**" />
		 <include name="dr/evomodelxml/branchratemodel/**" />
		 <include name="dr/evomodelxml/coalescent/**" />
		 <include name="dr/evomodelxml/sitemodel/**" />
		 <include name="dr/evomodelxml/tree/**" />
		 <include name="dr/app/beagle/tools/parsers/**" />
		 <include name="dr/evolution/io/Importer/**" />

      </javac>
      <echo message="Successfully compiled." />
   </target>


   <target name="clean">
      <delete dir="${build}" />
      <delete dir="${dist}" />
   </target>


</project>
